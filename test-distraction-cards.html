<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Distraction Cards Test - Dogs with Jobs</title>
  <style>
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      color: white;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      padding: 30px;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 30px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    
    .test-controls {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    button {
      padding: 10px 20px;
      background: white;
      color: #764ba2;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    .game-state {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .player-card {
      background: white;
      color: #333;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .player-card h3 {
      color: #764ba2;
      margin-top: 0;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }
    
    .hand-cards {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin: 10px 0;
    }
    
    .card {
      padding: 8px 12px;
      background: linear-gradient(135deg, #f093fb, #f5576c);
      color: white;
      border-radius: 5px;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .distraction-card {
      background: linear-gradient(135deg, #fa709a, #fee140);
    }
    
    .instant-badge {
      display: inline-block;
      background: #00b4d8;
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 11px;
      margin-left: 5px;
    }
    
    .end-badge {
      display: inline-block;
      background: #f4a261;
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 11px;
      margin-left: 5px;
    }
    
    .projects {
      background: white;
      color: #333;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }
    
    .log {
      background: rgba(0, 0, 0, 0.5);
      padding: 20px;
      border-radius: 10px;
      max-height: 300px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    
    .log-entry {
      margin: 5px 0;
      padding: 5px;
      background: rgba(255, 255, 255, 0.1);
      border-left: 3px solid #00b4d8;
    }
    
    .error {
      border-left-color: #f5576c;
      background: rgba(245, 87, 108, 0.1);
    }
    
    .success {
      border-left-color: #00d084;
      background: rgba(0, 208, 132, 0.1);
    }
    
    .status {
      display: flex;
      gap: 20px;
      margin: 20px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }
    
    .status-item {
      flex: 1;
      text-align: center;
    }
    
    .status-label {
      font-size: 12px;
      opacity: 0.8;
      margin-bottom: 5px;
    }
    
    .status-value {
      font-size: 24px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üêï Dogs with Jobs - Distraction Cards Test Suite</h1>
    
    <div class="test-controls">
      <button onclick="initGame()">Initialize Game</button>
      <button onclick="startBiddingPhase()">Start Bidding Phase</button>
      <button onclick="testSquirrel()">Test Squirrel!</button>
      <button onclick="testDoorbell()">Test Doorbell</button>
      <button onclick="testCoffeeSpill()">Test Coffee Spill</button>
      <button onclick="testPackMentality()">Test Pack Mentality</button>
      <button onclick="testAllInstant()">Test All Instant</button>
      <button onclick="testAllEnd()">Test All End-of-Turn</button>
      <button onclick="clearLog()">Clear Log</button>
    </div>
    
    <div class="status">
      <div class="status-item">
        <div class="status-label">Phase</div>
        <div class="status-value" id="currentPhase">Not Started</div>
      </div>
      <div class="status-item">
        <div class="status-label">Turn</div>
        <div class="status-value" id="currentTurn">0</div>
      </div>
      <div class="status-item">
        <div class="status-label">Round</div>
        <div class="status-value" id="currentRound">0</div>
      </div>
      <div class="status-item">
        <div class="status-label">Tests Passed</div>
        <div class="status-value" id="testsPassed">0/0</div>
      </div>
    </div>
    
    <div class="game-state">
      <div class="player-card">
        <h3>Player 1</h3>
        <div><strong>Position:</strong> <span id="p1-position">1</span></div>
        <div><strong>Action Cards:</strong></div>
        <div class="hand-cards" id="p1-actions"></div>
        <div><strong>Distraction Cards:</strong></div>
        <div class="hand-cards" id="p1-distractions"></div>
        <div><strong>Current Bid:</strong> <span id="p1-bid">None</span></div>
        <div><strong>Status:</strong> <span id="p1-status">Normal</span></div>
      </div>
      
      <div class="player-card">
        <h3>Player 2</h3>
        <div><strong>Position:</strong> <span id="p2-position">1</span></div>
        <div><strong>Action Cards:</strong></div>
        <div class="hand-cards" id="p2-actions"></div>
        <div><strong>Distraction Cards:</strong></div>
        <div class="hand-cards" id="p2-distractions"></div>
        <div><strong>Current Bid:</strong> <span id="p2-bid">None</span></div>
        <div><strong>Status:</strong> <span id="p2-status">Normal</span></div>
      </div>
    </div>
    
    <div class="projects">
      <h3>Available Projects</h3>
      <div id="projects-list"></div>
    </div>
    
    <div class="log">
      <h3>Test Log</h3>
      <div id="log-entries"></div>
    </div>
  </div>

  <script>
    let gameState = null;
    let testsRun = 0;
    let testsPassed = 0;
    
    function log(message, type = 'info') {
      const logDiv = document.getElementById('log-entries');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
    }
    
    function clearLog() {
      document.getElementById('log-entries').innerHTML = '';
      testsRun = 0;
      testsPassed = 0;
      updateTestCount();
    }
    
    function updateTestCount() {
      document.getElementById('testsPassed').textContent = `${testsPassed}/${testsRun}`;
    }
    
    function initGame() {
      gameState = {
        phase: 'setup',
        turn: 1,
        round: 0,
        players: [
          {
            id: 'p1',
            name: 'Player 1',
            position: 1,
            handAction: [
              { id: 'a1', name: 'Bark', energy: { comm: 2 } },
              { id: 'a2', name: 'Sit', energy: { focus: 1 } },
              { id: 'a3', name: 'Wag tail', energy: { social: 1 } },
              { id: 'a4', name: 'Run', energy: { phys: 2 } },
              { id: 'a5', name: 'Howl', energy: { comm: 2, focus: 1 } }
            ],
            handDistraction: [
              { id: 'd1', name: 'Squirrel!', type: 'instant', targetRequired: true, effect: 'Target discards 1 bid card' },
              { id: 'd2', name: 'Pack mentality', type: 'end', targetRequired: false, effect: 'Everyone passes 1 card clockwise' }
            ],
            bids: [[], [], []],
            status: [],
            skipNextRound: false,
            energyPenalty: 0
          },
          {
            id: 'p2',
            name: 'Player 2',
            position: 1,
            handAction: [
              { id: 'a6', name: 'Dig', energy: { phys: 2 } },
              { id: 'a7', name: 'Stay', energy: { focus: 2 } },
              { id: 'a8', name: 'Roll over', energy: { social: 1 } },
              { id: 'a9', name: 'Fetch', energy: { phys: 1, social: 1 } },
              { id: 'a10', name: 'Puppy eyes', energy: { social: 1, comm: 1 } }
            ],
            handDistraction: [
              { id: 'd3', name: 'Doorbell', type: 'instant', targetRequired: true, effect: 'Target cannot play cards next round' },
              { id: 'd4', name: 'Coffee spill', type: 'instant', targetRequired: true, effect: 'Target loses 1 energy next bid' }
            ],
            bids: [[], [], []],
            status: [],
            skipNextRound: false,
            energyPenalty: 0
          }
        ],
        projects: [
          { id: 'proj1', name: 'File paperwork', cost: { focus: 2 }, reward: 1 },
          { id: 'proj2', name: 'Answer phones', cost: { comm: 2 }, reward: 1 },
          { id: 'proj3', name: 'Coffee run', cost: { phys: 2 }, reward: 1 }
        ]
      };
      
      updateDisplay();
      log('Game initialized with 2 players and 3 projects', 'success');
    }
    
    function startBiddingPhase() {
      if (!gameState) {
        log('Initialize game first!', 'error');
        return;
      }
      gameState.phase = 'bidding';
      gameState.round = 1;
      updateDisplay();
      log('Started bidding phase - Round 1', 'success');
    }
    
    function updateDisplay() {
      if (!gameState) return;
      
      // Update status
      document.getElementById('currentPhase').textContent = gameState.phase;
      document.getElementById('currentTurn').textContent = gameState.turn;
      document.getElementById('currentRound').textContent = gameState.round;
      
      // Update players
      gameState.players.forEach((player, idx) => {
        const num = idx + 1;
        document.getElementById(`p${num}-position`).textContent = player.position;
        
        // Action cards
        const actionsDiv = document.getElementById(`p${num}-actions`);
        actionsDiv.innerHTML = '';
        player.handAction.forEach(card => {
          const cardEl = document.createElement('div');
          cardEl.className = 'card';
          cardEl.textContent = card.name;
          actionsDiv.appendChild(cardEl);
        });
        
        // Distraction cards
        const distractionsDiv = document.getElementById(`p${num}-distractions`);
        distractionsDiv.innerHTML = '';
        player.handDistraction.forEach(card => {
          const cardEl = document.createElement('div');
          cardEl.className = 'card distraction-card';
          const badge = card.type === 'instant' ? 
            '<span class="instant-badge">INSTANT</span>' : 
            '<span class="end-badge">END</span>';
          cardEl.innerHTML = card.name + badge;
          distractionsDiv.appendChild(cardEl);
        });
        
        // Current bid
        const currentBid = player.bids[gameState.round - 1] || [];
        document.getElementById(`p${num}-bid`).textContent = 
          currentBid.length > 0 ? `${currentBid.length} cards` : 'None';
        
        // Status
        let status = 'Normal';
        if (player.skipNextRound) status = 'Skip next round';
        if (player.energyPenalty > 0) status = `-${player.energyPenalty} energy penalty`;
        document.getElementById(`p${num}-status`).textContent = status;
      });
      
      // Update projects
      const projectsDiv = document.getElementById('projects-list');
      projectsDiv.innerHTML = '';
      gameState.projects.forEach(project => {
        const projEl = document.createElement('div');
        const cost = Object.entries(project.cost)
          .map(([type, val]) => `${val}${type}`)
          .join(', ');
        projEl.innerHTML = `<strong>${project.name}</strong> - Cost: ${cost}, Reward: +${project.reward} spaces`;
        projectsDiv.appendChild(projEl);
      });
    }
    
    function testSquirrel() {
      testsRun++;
      log('Testing Squirrel! (instant, targeted, discard bid)');
      
      if (!gameState || gameState.phase !== 'bidding') {
        log('Must be in bidding phase', 'error');
        return;
      }
      
      // Player 2 plays some bid cards
      gameState.players[1].bids[0] = [
        gameState.players[1].handAction[0],
        gameState.players[1].handAction[1]
      ];
      
      // Player 1 plays Squirrel! on Player 2
      const squirrelCard = gameState.players[0].handDistraction.find(c => c.name === 'Squirrel!');
      if (!squirrelCard) {
        log('Player 1 does not have Squirrel! card', 'error');
        return;
      }
      
      // Apply effect
      const discarded = gameState.players[1].bids[0].pop();
      if (discarded) {
        log(`Player 2 discarded bid card: ${discarded.name}`, 'success');
        testsPassed++;
      } else {
        log('Failed to discard bid card', 'error');
      }
      
      // Remove distraction from hand
      gameState.players[0].handDistraction = gameState.players[0].handDistraction.filter(c => c.id !== squirrelCard.id);
      
      updateDisplay();
      updateTestCount();
    }
    
    function testDoorbell() {
      testsRun++;
      log('Testing Doorbell (instant, targeted, skip next round)');
      
      if (!gameState || gameState.phase !== 'bidding') {
        log('Must be in bidding phase', 'error');
        return;
      }
      
      const doorbellCard = gameState.players[1].handDistraction.find(c => c.name === 'Doorbell');
      if (!doorbellCard) {
        log('Player 2 does not have Doorbell card', 'error');
        return;
      }
      
      // Apply effect to Player 1
      gameState.players[0].skipNextRound = true;
      log('Player 1 will skip next round', 'success');
      testsPassed++;
      
      // Remove distraction from hand
      gameState.players[1].handDistraction = gameState.players[1].handDistraction.filter(c => c.id !== doorbellCard.id);
      
      updateDisplay();
      updateTestCount();
    }
    
    function testCoffeeSpill() {
      testsRun++;
      log('Testing Coffee spill (instant, targeted, -1 energy)');
      
      if (!gameState || gameState.phase !== 'bidding') {
        log('Must be in bidding phase', 'error');
        return;
      }
      
      const coffeeCard = gameState.players[1].handDistraction.find(c => c.name === 'Coffee spill');
      if (!coffeeCard) {
        log('Player 2 does not have Coffee spill card', 'error');
        return;
      }
      
      // Apply effect to Player 1
      gameState.players[0].energyPenalty = 1;
      log('Player 1 has -1 energy penalty on next bid', 'success');
      testsPassed++;
      
      // Remove distraction from hand
      gameState.players[1].handDistraction = gameState.players[1].handDistraction.filter(c => c.id !== coffeeCard.id);
      
      updateDisplay();
      updateTestCount();
    }
    
    function testPackMentality() {
      testsRun++;
      log('Testing Pack mentality (end-of-turn, non-targeted, pass cards)');
      
      if (!gameState) {
        log('Initialize game first', 'error');
        return;
      }
      
      const packCard = gameState.players[0].handDistraction.find(c => c.name === 'Pack mentality');
      if (!packCard) {
        log('Player 1 does not have Pack mentality card', 'error');
        return;
      }
      
      // Save original hands
      const p1FirstCard = gameState.players[0].handAction[0];
      const p2FirstCard = gameState.players[1].handAction[0];
      
      // Simulate passing cards clockwise (p1 -> p2, p2 -> p1)
      const temp = gameState.players[0].handAction.shift();
      gameState.players[0].handAction.push(gameState.players[1].handAction.shift());
      gameState.players[1].handAction.push(temp);
      
      log(`Cards passed: P1 gave ${p1FirstCard.name} to P2, P2 gave ${p2FirstCard.name} to P1`, 'success');
      testsPassed++;
      
      // Remove distraction from hand
      gameState.players[0].handDistraction = gameState.players[0].handDistraction.filter(c => c.id !== packCard.id);
      
      updateDisplay();
      updateTestCount();
    }
    
    function testAllInstant() {
      log('=== TESTING ALL INSTANT DISTRACTIONS ===', 'success');
      initGame();
      startBiddingPhase();
      testSquirrel();
      testDoorbell();
      testCoffeeSpill();
      log('=== INSTANT TESTS COMPLETE ===', 'success');
    }
    
    function testAllEnd() {
      log('=== TESTING ALL END-OF-TURN DISTRACTIONS ===', 'success');
      initGame();
      testPackMentality();
      log('=== END-OF-TURN TESTS COMPLETE ===', 'success');
    }
    
    // Initialize on load
    window.addEventListener('DOMContentLoaded', () => {
      log('Distraction Cards Test Suite loaded', 'success');
      log('Click "Initialize Game" to begin testing');
    });
  </script>
</body>
</html>